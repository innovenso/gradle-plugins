plugins {
    id 'groovy-gradle-plugin'
    id 'groovy'
    id "com.jfrog.artifactory" version "4.17.2"
    id 'maven-publish'
    id "com.diffplug.gradle.spotless" version "3.26.1"
}

group 'com.innovenso.gradle'

sourceCompatibility = '1.11'
targetCompatibility = '1.11'

apply from: 'dependencies.gradle'
apply plugin: com.innovenso.gradle.plugin.version.VersioningPlugin

 gradlePlugin {
     plugins {
         versionPlugin {
             id = 'com.innovenso.version'
             implementationClass = 'com.innovenso.gradle.plugin.version.VersioningPlugin'
         }
     }
 }

publishing {
    publications {
        pluginPublication (MavenPublication) {
            from components.java
        }
    }
}

artifactory {
    contextUrl = System.getenv("ARTIFACTORY_CONTEXTURL")
    publish {
        repository {
            repoKey = 'innovenso'
            username = System.getenv("ARTIFACTORY_USERNAME")
            password = System.getenv("ARTIFACTORY_PASSWORD")
            maven = true
        }
        defaults {
            publications ('pluginPublication')
        }
    }
    resolve {
        repository {
            repoKey = 'repo'
            username = System.getenv("ARTIFACTORY_USERNAME")
            password = System.getenv("ARTIFACTORY_PASSWORD")
            maven = true
        }
    }
}

publish.dependsOn(artifactoryPublish)

spotless {
    java {
        googleJavaFormat()
    }
    groovy {
        greclipse()
    }
}

